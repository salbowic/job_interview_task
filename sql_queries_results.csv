Text Query;Generated SQL Query
Show me the names of employees and their departments.;"SELECT e.first_name, e.last_name, d.department_name FROM sales.employees AS e JOIN sales.departments AS d ON e.department_id = d.department_id;"
What is the highest salary?;"SELECT MAX(salaries.salary_amount::TEXT::INT) AS max_salary FROM salaries;"
List all orders that were made in the last 30 days.;"SELECT sales.orders.order_date, sales.orders.customer_id, sales.orders.sales_rep_id FROM sales.orders WHERE sales.orders.order_date >= (CURRENT_DATE - interval '30 day');"
What are the total sales grouped by region?;"SELECT analytics.sales_reports.region, SUM(analytics.sales_reports.total_sales) AS total_sale FROM analytics.sales_reports GROUP BY analytics.sales_reports.region;"
List employees whose salary is greater than $50,000.;"SELECT sales.employees.first_name, sales.employees.last_name FROM sales.employees JOIN sales.salaries ON sales.employees.employee_id = sales.salaries.employee_id WHERE sales.salaries.salary_amount > 50000;"
Get the names of customers and their lifetime value.;"SELECT customer_name, lifetime_value::TEXT AS lifetime_value FROM sales.customers JOIN analytics.customer_metrics ON sales.customers.customer_id = analytics.customer_metrics.customer_id;"
Show products where the sales quantity is above 100.;"SELECT product_performance.product_id, product_performance.sales_quantity FROM analytics.product_performance WHERE product_performance.sales_quantity > 100;"
Which departments are managed by the employee with ID 5?;"SELECT department_name FROM sales.departments WHERE manager_id = 5;"
List all sales representatives working in the 'West' region.;"SELECT sales.sales_reps.first_name, sales.sales_reps.last_name FROM sales.sales_reps WHERE sales.sales_reps.region = 'West';"
What is the most recent sales report date?;"SELECT MAX(report_date::TEXT::DATE) AS latest_sales_report_date FROM analytics.sales_reports;"
Find the average salary of employees in each department.;"SELECT d.department_name, AVG(s.salary_amount) AS avg_salary FROM sales.salaries s JOIN sales.employees e ON s.employee_id = e.employee_id JOIN sales.departments d ON e.department_id = d.department_id GROUP BY d.department_name;"
List customers who have placed more than 5 orders.;"SELECT customer_name, COUNT(order_id) AS order_count FROM sales.orders GROUP BY customer_name HAVING COUNT(order_id) > 5;"
Find the total revenue generated by each product.;"SELECT p.product_name, SUM(pp.revenue_generated) AS total_revenue FROM sales.products AS p JOIN analytics.product_performance AS pp ON p.product_id = pp.product_id GROUP BY p.product_name ORDER BY total_revenue DESC;"
Show the department with the highest number of employees.;"SELECT departments.department_name, COUNT(DISTINCT employees.employee_id) AS employee_count FROM employees JOIN sales.orders ON employees.manager_id::text = orders.sales_rep_id::TEXT GROUP BY departments.department_name ORDER BY employee_count DESC NULLS LAST LIMIT 1;"
Get the total number of sales representatives in each region.;"SELECT sales.sales_reps.region, COUNT(DISTINCT sales.sales_reps.sales_rep_id) AS number_of_sales_reps FROM sales.sales_reps GROUP BY sales.sales_reps.region;"
Find the average lifetime value of customers grouped by region.;"SELECT sales_reps.region, AVG(customer_metrics.lifetime_value) AS avg_life_time_value FROM customer_metrics JOIN orders ON customer_metrics.customer_id = orders.customer_id JOIN sales_reps ON orders.sales_rep_id::integer = sales_reps.sales_rep_id GROUP BY sales_reps.region;"
List the top 3 products with the highest revenue.;"SELECT p.product_name, to_char(to_timestamp(ppe.revenue_generated::text::integer,'YYYYMMDD'), 'Day DD Mon YYYY') AS sales_day, SUM(ppe.sales_quantity) AS total_sales FROM analytics.product_performance ppe JOIN sales.products p ON ppe.product_id = p.product_id GROUP BY p.product_name, sales_day ORDER BY total_sales DESC LIMIT 3;"
Find employees who have not received a salary in the last year.;"SELECT e.""employee_id"", e.""first_name"", e.""last_name"" FROM sales.employees AS e WHERE NOT EXISTS (SELECT 1 FROM sales.salaries s WHERE e.""employee_id"" = s.""employee_id"" AND s.""effective_date"" >= CURRENT_DATE - INTERVAL '1 year') ORDER BY e.""first_name"", e.""last_name"";"
Show the total number of orders per customer.;"SELECT sales.orders.customer_id, COUNT(sales.orders.order_id) AS order_count FROM sales.orders GROUP BY sales.orders.customer_id;"
List all departments with more than one manager.;"SELECT department_name, COUNT(manager_id) AS managers FROM public.departments GROUP BY department_name HAVING COUNT(manager_id) > 1;"
