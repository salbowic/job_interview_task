Text Query;Generated SQL Query
Show me the names of employees and their departments.;"SELECT e.first_name, e.last_name, d.department_name FROM sales.employees AS e JOIN sales.departments AS d ON e.department_id = d.department_id;"
What is the highest salary?;"SELECT MAX(salaries.salary_amount::TEXT::INT) AS highest_salary FROM salaries;"
List all orders that were made in the last 30 days.;"SELECT order_date::TEXT, customer_id::TEXT, sales_rep_id::TEXT FROM sales.orders WHERE order_date >= (CURRENT_DATE - interval '30 day');"
What are the total sales grouped by region?;"SELECT sales.sales_reps.region, SUM(analytics.sales_reports.total_sales) AS total_sales FROM sales.orders JOIN sales.sales_reps ON orders.sales_rep_id = sales.sales_reps.employee_id JOIN analytics.sales_reports ON sales.sales_reps.region = analytics.sales_reports.region GROUP BY sales.sales_reps.region;"
List employees whose salary is greater than $50,000.;"SELECT e.""first_name"", e.""last_name"" FROM sales.employees AS e JOIN sales.salaries s ON e.employee_id = s.employee_id WHERE s.salary_amount > '50,000'::money;"
Get the names of customers and their lifetime value.;SELECT sales.customers.customer_name, analytics.customer_metrics.lifetime_value FROM sales.customers JOIN sales.orders ON sales.customers.customer_id = sales.orders.order_id JOIN sales.sales_reps ON sales.orders.order_id = sales.sales_reps.employee_id JOIN sales.products ON sales.orders.order_id::integer::int4 = sales.products.product_id::integer::int4 JOIN analytics.sales_reports ON sales.customers.customer_id::integer::int4::TEXT::VARCHAR::TEXT::bigint::numeric::text::varchar::date::timestamp::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::day::
Show products where the sales quantity is above 100.;"SELECT sales.products.product_name FROM sales.products JOIN analytics.product_performance ON sales.products.product_id = analytics.product_performance.product_id WHERE analytics.product_performance.sales_quantity > 100;"
Which departments are managed by the employee with ID 5?;"SELECT department_name FROM public.departments WHERE manager_id = 5;"
List all sales representatives working in the 'West' region.;SELECT sales.sales_reps.first_name, sales.sales_reps.last_name FROM sales.sales_reps WHERE sales.sales_reps.region ilike '%West%'
What is the most recent sales report date?;"SELECT MAX(report_date::TEXT::DATE) AS latest_sales_report_date FROM analytics.sales_reports;"
Find the average salary of employees in each department.;"SELECT AVG(salaries.salary_amount::FLOAT) AS avg_salary, departments.department_name FROM salaries JOIN employees ON salaries.employee_id = employees.employee_id JOIN departments ON employees.department_id = departments.department_id GROUP BY departments.department_name;"
List customers who have placed more than 5 orders.;"SELECT sales.orders.customer_id, COUNT(sales.orders.order_id) AS order_count FROM sales.orders GROUP BY sales.orders.customer_id HAVING COUNT(sales.orders.order_id) > 5;"
Find the total revenue generated by each product.;"SELECT p.product_name, SUM(pp.revenue_generated) AS total_revenue FROM sales.products p JOIN analytics.product_performance pp ON (p.product_id::TEXT::INTEGER = pp.product_id::TEXT::INTEGER) GROUP BY p.product_name ORDER BY total_revenue DESC NULLS LAST;"
Show the department with the highest number of employees.;"SELECT d.department_name, COUNT(e.employee_id) AS employee_count FROM public.employees e JOIN sales.departments d ON e.department_id::integer = d.department_id GROUP BY d.department_name ORDER BY employee_count DESC LIMIT 1;"
Get the total number of sales representatives in each region.;"SELECT sales_reps.region, COUNT(DISTINCT sales_rep_id) AS number_of_sales_reps FROM sales.sales_reps GROUP BY sales_reps.region;"
Find the average lifetime value of customers grouped by region.;"SELECT sales_reps.region, AVG(customer_metrics.lifetime_value) AS avg_lifetime_value FROM sales.sales_reps JOIN sales.orders ON sales.sales_reps.employee_id = sales.orders.sales_rep_id JOIN sales.customers ON sales.orders.customer_id = sales.customers.customer_id JOIN analytics.customer_metrics ON sales.customers.customer_id = customer_metrics.customer_id GROUP BY sales_reps.region;"
List the top 3 products with the highest revenue.;"SELECT
    p.product_name,
    SUM(pp.revenue_generated) AS revenue_total
FROM sales.products AS p
INNER JOIN
    analytics.product_performance AS pp
    ON CAST(CAST(p.product_id AS text) AS integer) = pp.product_id
GROUP BY p.product_name
ORDER BY revenue_total DESC NULLS LAST
LIMIT 3;
"
Find employees who have not received a salary in the last year.;"SELECT
    employee_id,
    first_name,
    last_name
FROM sales.employees
WHERE
    employee_id NOT IN (SELECT employee_id FROM sales.salaries) AND CURRENT_DATE - effective_date < INTERVAL '1 year';
"
Show the total number of orders per customer.;"SELECT sales.orders.customer_id, COUNT(sales.orders.order_id) AS order_count FROM sales.orders GROUP BY sales.orders.customer_id;"
List all departments with more than one manager.;"SELECT department_name FROM analytics.employee_manager_relationship WHERE num_managers > 1;"
